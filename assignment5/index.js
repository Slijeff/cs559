"use strict";(()=>{var Hr=Object.defineProperty;var ar=(r,e)=>{for(var n in e)Hr(r,n,{get:e[n],enumerable:!0})};var P=1e-6,I=typeof Float32Array!="undefined"?Float32Array:Array,V=Math.random;var s1=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function pr(){var r=new I(9);return I!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}var O={};ar(O,{add:()=>Se,adjoint:()=>Kr,clone:()=>Wr,copy:()=>Xr,create:()=>Br,decompose:()=>Me,determinant:()=>ur,equals:()=>Oe,exactEquals:()=>Ie,frob:()=>Re,fromQuat:()=>ye,fromQuat2:()=>pe,fromRotation:()=>ce,fromRotationTranslation:()=>yr,fromRotationTranslationScale:()=>fe,fromRotationTranslationScaleOrigin:()=>me,fromScaling:()=>he,fromTranslation:()=>se,fromValues:()=>jr,fromXRotation:()=>xe,fromYRotation:()=>ve,fromZRotation:()=>le,frustum:()=>ge,getRotation:()=>_r,getScaling:()=>dr,getTranslation:()=>gr,identity:()=>fr,invert:()=>Jr,lookAt:()=>we,mul:()=>be,multiply:()=>mr,multiplyScalar:()=>Le,multiplyScalarAndAdd:()=>Ye,ortho:()=>Ee,orthoNO:()=>Er,orthoZO:()=>Te,perspective:()=>de,perspectiveFromFieldOfView:()=>ze,perspectiveNO:()=>zr,perspectiveZO:()=>_e,rotate:()=>ne,rotateX:()=>te,rotateY:()=>ae,rotateZ:()=>ie,scale:()=>ee,set:()=>Gr,str:()=>Pe,sub:()=>qe,subtract:()=>Tr,targetTo:()=>Ae,translate:()=>re,transpose:()=>Ur});function Br(){var r=new I(16);return I!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function Wr(r){var e=new I(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Xr(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function jr(r,e,n,t,a,i,s,h,c,x,v,p,f,M,m,y){var l=new I(16);return l[0]=r,l[1]=e,l[2]=n,l[3]=t,l[4]=a,l[5]=i,l[6]=s,l[7]=h,l[8]=c,l[9]=x,l[10]=v,l[11]=p,l[12]=f,l[13]=M,l[14]=m,l[15]=y,l}function Gr(r,e,n,t,a,i,s,h,c,x,v,p,f,M,m,y,l){return r[0]=e,r[1]=n,r[2]=t,r[3]=a,r[4]=i,r[5]=s,r[6]=h,r[7]=c,r[8]=x,r[9]=v,r[10]=p,r[11]=f,r[12]=M,r[13]=m,r[14]=y,r[15]=l,r}function fr(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Ur(r,e){if(r===e){var n=e[1],t=e[2],a=e[3],i=e[6],s=e[7],h=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=n,r[6]=e[9],r[7]=e[13],r[8]=t,r[9]=i,r[11]=e[14],r[12]=a,r[13]=s,r[14]=h}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function Jr(r,e){var n=e[0],t=e[1],a=e[2],i=e[3],s=e[4],h=e[5],c=e[6],x=e[7],v=e[8],p=e[9],f=e[10],M=e[11],m=e[12],y=e[13],l=e[14],E=e[15],A=n*h-t*s,z=n*c-a*s,g=n*x-i*s,d=t*c-a*h,_=t*x-i*h,L=a*x-i*c,R=v*y-p*m,Y=v*l-f*m,T=v*E-M*m,b=p*l-f*y,q=p*E-M*y,N=f*E-M*l,S=A*N-z*q+g*b+d*T-_*Y+L*R;return S?(S=1/S,r[0]=(h*N-c*q+x*b)*S,r[1]=(a*q-t*N-i*b)*S,r[2]=(y*L-l*_+E*d)*S,r[3]=(f*_-p*L-M*d)*S,r[4]=(c*T-s*N-x*Y)*S,r[5]=(n*N-a*T+i*Y)*S,r[6]=(l*g-m*L-E*z)*S,r[7]=(v*L-f*g+M*z)*S,r[8]=(s*q-h*T+x*R)*S,r[9]=(t*T-n*q-i*R)*S,r[10]=(m*_-y*g+E*A)*S,r[11]=(p*g-v*_-M*A)*S,r[12]=(h*Y-s*b-c*R)*S,r[13]=(n*b-t*Y+a*R)*S,r[14]=(y*z-m*d-l*A)*S,r[15]=(v*d-p*z+f*A)*S,r):null}function Kr(r,e){var n=e[0],t=e[1],a=e[2],i=e[3],s=e[4],h=e[5],c=e[6],x=e[7],v=e[8],p=e[9],f=e[10],M=e[11],m=e[12],y=e[13],l=e[14],E=e[15],A=n*h-t*s,z=n*c-a*s,g=n*x-i*s,d=t*c-a*h,_=t*x-i*h,L=a*x-i*c,R=v*y-p*m,Y=v*l-f*m,T=v*E-M*m,b=p*l-f*y,q=p*E-M*y,N=f*E-M*l;return r[0]=h*N-c*q+x*b,r[1]=a*q-t*N-i*b,r[2]=y*L-l*_+E*d,r[3]=f*_-p*L-M*d,r[4]=c*T-s*N-x*Y,r[5]=n*N-a*T+i*Y,r[6]=l*g-m*L-E*z,r[7]=v*L-f*g+M*z,r[8]=s*q-h*T+x*R,r[9]=t*T-n*q-i*R,r[10]=m*_-y*g+E*A,r[11]=p*g-v*_-M*A,r[12]=h*Y-s*b-c*R,r[13]=n*b-t*Y+a*R,r[14]=y*z-m*d-l*A,r[15]=v*d-p*z+f*A,r}function ur(r){var e=r[0],n=r[1],t=r[2],a=r[3],i=r[4],s=r[5],h=r[6],c=r[7],x=r[8],v=r[9],p=r[10],f=r[11],M=r[12],m=r[13],y=r[14],l=r[15],E=e*s-n*i,A=e*h-t*i,z=n*h-t*s,g=x*m-v*M,d=x*y-p*M,_=v*y-p*m,L=e*_-n*d+t*g,R=i*_-s*d+h*g,Y=x*z-v*A+p*E,T=M*z-m*A+y*E;return c*L-a*R+l*Y-f*T}function mr(r,e,n){var t=e[0],a=e[1],i=e[2],s=e[3],h=e[4],c=e[5],x=e[6],v=e[7],p=e[8],f=e[9],M=e[10],m=e[11],y=e[12],l=e[13],E=e[14],A=e[15],z=n[0],g=n[1],d=n[2],_=n[3];return r[0]=z*t+g*h+d*p+_*y,r[1]=z*a+g*c+d*f+_*l,r[2]=z*i+g*x+d*M+_*E,r[3]=z*s+g*v+d*m+_*A,z=n[4],g=n[5],d=n[6],_=n[7],r[4]=z*t+g*h+d*p+_*y,r[5]=z*a+g*c+d*f+_*l,r[6]=z*i+g*x+d*M+_*E,r[7]=z*s+g*v+d*m+_*A,z=n[8],g=n[9],d=n[10],_=n[11],r[8]=z*t+g*h+d*p+_*y,r[9]=z*a+g*c+d*f+_*l,r[10]=z*i+g*x+d*M+_*E,r[11]=z*s+g*v+d*m+_*A,z=n[12],g=n[13],d=n[14],_=n[15],r[12]=z*t+g*h+d*p+_*y,r[13]=z*a+g*c+d*f+_*l,r[14]=z*i+g*x+d*M+_*E,r[15]=z*s+g*v+d*m+_*A,r}function re(r,e,n){var t=n[0],a=n[1],i=n[2],s,h,c,x,v,p,f,M,m,y,l,E;return e===r?(r[12]=e[0]*t+e[4]*a+e[8]*i+e[12],r[13]=e[1]*t+e[5]*a+e[9]*i+e[13],r[14]=e[2]*t+e[6]*a+e[10]*i+e[14],r[15]=e[3]*t+e[7]*a+e[11]*i+e[15]):(s=e[0],h=e[1],c=e[2],x=e[3],v=e[4],p=e[5],f=e[6],M=e[7],m=e[8],y=e[9],l=e[10],E=e[11],r[0]=s,r[1]=h,r[2]=c,r[3]=x,r[4]=v,r[5]=p,r[6]=f,r[7]=M,r[8]=m,r[9]=y,r[10]=l,r[11]=E,r[12]=s*t+v*a+m*i+e[12],r[13]=h*t+p*a+y*i+e[13],r[14]=c*t+f*a+l*i+e[14],r[15]=x*t+M*a+E*i+e[15]),r}function ee(r,e,n){var t=n[0],a=n[1],i=n[2];return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*a,r[5]=e[5]*a,r[6]=e[6]*a,r[7]=e[7]*a,r[8]=e[8]*i,r[9]=e[9]*i,r[10]=e[10]*i,r[11]=e[11]*i,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function ne(r,e,n,t){var a=t[0],i=t[1],s=t[2],h=Math.hypot(a,i,s),c,x,v,p,f,M,m,y,l,E,A,z,g,d,_,L,R,Y,T,b,q,N,S,D;return h<P?null:(h=1/h,a*=h,i*=h,s*=h,c=Math.sin(n),x=Math.cos(n),v=1-x,p=e[0],f=e[1],M=e[2],m=e[3],y=e[4],l=e[5],E=e[6],A=e[7],z=e[8],g=e[9],d=e[10],_=e[11],L=a*a*v+x,R=i*a*v+s*c,Y=s*a*v-i*c,T=a*i*v-s*c,b=i*i*v+x,q=s*i*v+a*c,N=a*s*v+i*c,S=i*s*v-a*c,D=s*s*v+x,r[0]=p*L+y*R+z*Y,r[1]=f*L+l*R+g*Y,r[2]=M*L+E*R+d*Y,r[3]=m*L+A*R+_*Y,r[4]=p*T+y*b+z*q,r[5]=f*T+l*b+g*q,r[6]=M*T+E*b+d*q,r[7]=m*T+A*b+_*q,r[8]=p*N+y*S+z*D,r[9]=f*N+l*S+g*D,r[10]=M*N+E*S+d*D,r[11]=m*N+A*S+_*D,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function te(r,e,n){var t=Math.sin(n),a=Math.cos(n),i=e[4],s=e[5],h=e[6],c=e[7],x=e[8],v=e[9],p=e[10],f=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=i*a+x*t,r[5]=s*a+v*t,r[6]=h*a+p*t,r[7]=c*a+f*t,r[8]=x*a-i*t,r[9]=v*a-s*t,r[10]=p*a-h*t,r[11]=f*a-c*t,r}function ae(r,e,n){var t=Math.sin(n),a=Math.cos(n),i=e[0],s=e[1],h=e[2],c=e[3],x=e[8],v=e[9],p=e[10],f=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=i*a-x*t,r[1]=s*a-v*t,r[2]=h*a-p*t,r[3]=c*a-f*t,r[8]=i*t+x*a,r[9]=s*t+v*a,r[10]=h*t+p*a,r[11]=c*t+f*a,r}function ie(r,e,n){var t=Math.sin(n),a=Math.cos(n),i=e[0],s=e[1],h=e[2],c=e[3],x=e[4],v=e[5],p=e[6],f=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=i*a+x*t,r[1]=s*a+v*t,r[2]=h*a+p*t,r[3]=c*a+f*t,r[4]=x*a-i*t,r[5]=v*a-s*t,r[6]=p*a-h*t,r[7]=f*a-c*t,r}function se(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function he(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ce(r,e,n){var t=n[0],a=n[1],i=n[2],s=Math.hypot(t,a,i),h,c,x;return s<P?null:(s=1/s,t*=s,a*=s,i*=s,h=Math.sin(e),c=Math.cos(e),x=1-c,r[0]=t*t*x+c,r[1]=a*t*x+i*h,r[2]=i*t*x-a*h,r[3]=0,r[4]=t*a*x-i*h,r[5]=a*a*x+c,r[6]=i*a*x+t*h,r[7]=0,r[8]=t*i*x+a*h,r[9]=a*i*x-t*h,r[10]=i*i*x+c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function xe(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=n,r[7]=0,r[8]=0,r[9]=-n,r[10]=t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ve(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=t,r[1]=0,r[2]=-n,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=n,r[9]=0,r[10]=t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function le(r,e){var n=Math.sin(e),t=Math.cos(e);return r[0]=t,r[1]=n,r[2]=0,r[3]=0,r[4]=-n,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function yr(r,e,n){var t=e[0],a=e[1],i=e[2],s=e[3],h=t+t,c=a+a,x=i+i,v=t*h,p=t*c,f=t*x,M=a*c,m=a*x,y=i*x,l=s*h,E=s*c,A=s*x;return r[0]=1-(M+y),r[1]=p+A,r[2]=f-E,r[3]=0,r[4]=p-A,r[5]=1-(v+y),r[6]=m+l,r[7]=0,r[8]=f+E,r[9]=m-l,r[10]=1-(v+M),r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function pe(r,e){var n=new I(3),t=-e[0],a=-e[1],i=-e[2],s=e[3],h=e[4],c=e[5],x=e[6],v=e[7],p=t*t+a*a+i*i+s*s;return p>0?(n[0]=(h*s+v*t+c*i-x*a)*2/p,n[1]=(c*s+v*a+x*t-h*i)*2/p,n[2]=(x*s+v*i+h*a-c*t)*2/p):(n[0]=(h*s+v*t+c*i-x*a)*2,n[1]=(c*s+v*a+x*t-h*i)*2,n[2]=(x*s+v*i+h*a-c*t)*2),yr(r,e,n),r}function gr(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function dr(r,e){var n=e[0],t=e[1],a=e[2],i=e[4],s=e[5],h=e[6],c=e[8],x=e[9],v=e[10];return r[0]=Math.hypot(n,t,a),r[1]=Math.hypot(i,s,h),r[2]=Math.hypot(c,x,v),r}function _r(r,e){var n=new I(3);dr(n,e);var t=1/n[0],a=1/n[1],i=1/n[2],s=e[0]*t,h=e[1]*a,c=e[2]*i,x=e[4]*t,v=e[5]*a,p=e[6]*i,f=e[8]*t,M=e[9]*a,m=e[10]*i,y=s+v+m,l=0;return y>0?(l=Math.sqrt(y+1)*2,r[3]=.25*l,r[0]=(p-M)/l,r[1]=(f-c)/l,r[2]=(h-x)/l):s>v&&s>m?(l=Math.sqrt(1+s-v-m)*2,r[3]=(p-M)/l,r[0]=.25*l,r[1]=(h+x)/l,r[2]=(f+c)/l):v>m?(l=Math.sqrt(1+v-s-m)*2,r[3]=(f-c)/l,r[0]=(h+x)/l,r[1]=.25*l,r[2]=(p+M)/l):(l=Math.sqrt(1+m-s-v)*2,r[3]=(h-x)/l,r[0]=(f+c)/l,r[1]=(p+M)/l,r[2]=.25*l),r}function Me(r,e,n,t){e[0]=t[12],e[1]=t[13],e[2]=t[14];var a=t[0],i=t[1],s=t[2],h=t[4],c=t[5],x=t[6],v=t[8],p=t[9],f=t[10];n[0]=Math.hypot(a,i,s),n[1]=Math.hypot(h,c,x),n[2]=Math.hypot(v,p,f);var M=1/n[0],m=1/n[1],y=1/n[2],l=a*M,E=i*m,A=s*y,z=h*M,g=c*m,d=x*y,_=v*M,L=p*m,R=f*y,Y=l+g+R,T=0;return Y>0?(T=Math.sqrt(Y+1)*2,r[3]=.25*T,r[0]=(d-L)/T,r[1]=(_-A)/T,r[2]=(E-z)/T):l>g&&l>R?(T=Math.sqrt(1+l-g-R)*2,r[3]=(d-L)/T,r[0]=.25*T,r[1]=(E+z)/T,r[2]=(_+A)/T):g>R?(T=Math.sqrt(1+g-l-R)*2,r[3]=(_-A)/T,r[0]=(E+z)/T,r[1]=.25*T,r[2]=(d+L)/T):(T=Math.sqrt(1+R-l-g)*2,r[3]=(E-z)/T,r[0]=(_+A)/T,r[1]=(d+L)/T,r[2]=.25*T),r}function fe(r,e,n,t){var a=e[0],i=e[1],s=e[2],h=e[3],c=a+a,x=i+i,v=s+s,p=a*c,f=a*x,M=a*v,m=i*x,y=i*v,l=s*v,E=h*c,A=h*x,z=h*v,g=t[0],d=t[1],_=t[2];return r[0]=(1-(m+l))*g,r[1]=(f+z)*g,r[2]=(M-A)*g,r[3]=0,r[4]=(f-z)*d,r[5]=(1-(p+l))*d,r[6]=(y+E)*d,r[7]=0,r[8]=(M+A)*_,r[9]=(y-E)*_,r[10]=(1-(p+m))*_,r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function me(r,e,n,t,a){var i=e[0],s=e[1],h=e[2],c=e[3],x=i+i,v=s+s,p=h+h,f=i*x,M=i*v,m=i*p,y=s*v,l=s*p,E=h*p,A=c*x,z=c*v,g=c*p,d=t[0],_=t[1],L=t[2],R=a[0],Y=a[1],T=a[2],b=(1-(y+E))*d,q=(M+g)*d,N=(m-z)*d,S=(M-g)*_,D=(1-(f+E))*_,$=(l+A)*_,H=(m+z)*L,vr=(l-A)*L,lr=(1-(f+y))*L;return r[0]=b,r[1]=q,r[2]=N,r[3]=0,r[4]=S,r[5]=D,r[6]=$,r[7]=0,r[8]=H,r[9]=vr,r[10]=lr,r[11]=0,r[12]=n[0]+R-(b*R+S*Y+H*T),r[13]=n[1]+Y-(q*R+D*Y+vr*T),r[14]=n[2]+T-(N*R+$*Y+lr*T),r[15]=1,r}function ye(r,e){var n=e[0],t=e[1],a=e[2],i=e[3],s=n+n,h=t+t,c=a+a,x=n*s,v=t*s,p=t*h,f=a*s,M=a*h,m=a*c,y=i*s,l=i*h,E=i*c;return r[0]=1-p-m,r[1]=v+E,r[2]=f-l,r[3]=0,r[4]=v-E,r[5]=1-x-m,r[6]=M+y,r[7]=0,r[8]=f+l,r[9]=M-y,r[10]=1-x-p,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ge(r,e,n,t,a,i,s){var h=1/(n-e),c=1/(a-t),x=1/(i-s);return r[0]=i*2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i*2*c,r[6]=0,r[7]=0,r[8]=(n+e)*h,r[9]=(a+t)*c,r[10]=(s+i)*x,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*i*2*x,r[15]=0,r}function zr(r,e,n,t,a){var i=1/Math.tan(e/2);if(r[0]=i/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,a!=null&&a!==1/0){var s=1/(t-a);r[10]=(a+t)*s,r[14]=2*a*t*s}else r[10]=-1,r[14]=-2*t;return r}var de=zr;function _e(r,e,n,t,a){var i=1/Math.tan(e/2);if(r[0]=i/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,a!=null&&a!==1/0){var s=1/(t-a);r[10]=a*s,r[14]=a*t*s}else r[10]=-1,r[14]=-t;return r}function ze(r,e,n,t){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),h=Math.tan(e.rightDegrees*Math.PI/180),c=2/(s+h),x=2/(a+i);return r[0]=c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=x,r[6]=0,r[7]=0,r[8]=-((s-h)*c*.5),r[9]=(a-i)*x*.5,r[10]=t/(n-t),r[11]=-1,r[12]=0,r[13]=0,r[14]=t*n/(n-t),r[15]=0,r}function Er(r,e,n,t,a,i,s){var h=1/(e-n),c=1/(t-a),x=1/(i-s);return r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*x,r[11]=0,r[12]=(e+n)*h,r[13]=(a+t)*c,r[14]=(s+i)*x,r[15]=1,r}var Ee=Er;function Te(r,e,n,t,a,i,s){var h=1/(e-n),c=1/(t-a),x=1/(i-s);return r[0]=-2*h,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=x,r[11]=0,r[12]=(e+n)*h,r[13]=(a+t)*c,r[14]=i*x,r[15]=1,r}function we(r,e,n,t){var a,i,s,h,c,x,v,p,f,M,m=e[0],y=e[1],l=e[2],E=t[0],A=t[1],z=t[2],g=n[0],d=n[1],_=n[2];return Math.abs(m-g)<P&&Math.abs(y-d)<P&&Math.abs(l-_)<P?fr(r):(v=m-g,p=y-d,f=l-_,M=1/Math.hypot(v,p,f),v*=M,p*=M,f*=M,a=A*f-z*p,i=z*v-E*f,s=E*p-A*v,M=Math.hypot(a,i,s),M?(M=1/M,a*=M,i*=M,s*=M):(a=0,i=0,s=0),h=p*s-f*i,c=f*a-v*s,x=v*i-p*a,M=Math.hypot(h,c,x),M?(M=1/M,h*=M,c*=M,x*=M):(h=0,c=0,x=0),r[0]=a,r[1]=h,r[2]=v,r[3]=0,r[4]=i,r[5]=c,r[6]=p,r[7]=0,r[8]=s,r[9]=x,r[10]=f,r[11]=0,r[12]=-(a*m+i*y+s*l),r[13]=-(h*m+c*y+x*l),r[14]=-(v*m+p*y+f*l),r[15]=1,r)}function Ae(r,e,n,t){var a=e[0],i=e[1],s=e[2],h=t[0],c=t[1],x=t[2],v=a-n[0],p=i-n[1],f=s-n[2],M=v*v+p*p+f*f;M>0&&(M=1/Math.sqrt(M),v*=M,p*=M,f*=M);var m=c*f-x*p,y=x*v-h*f,l=h*p-c*v;return M=m*m+y*y+l*l,M>0&&(M=1/Math.sqrt(M),m*=M,y*=M,l*=M),r[0]=m,r[1]=y,r[2]=l,r[3]=0,r[4]=p*l-f*y,r[5]=f*m-v*l,r[6]=v*y-p*m,r[7]=0,r[8]=v,r[9]=p,r[10]=f,r[11]=0,r[12]=a,r[13]=i,r[14]=s,r[15]=1,r}function Pe(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function Re(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}function Se(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r[6]=e[6]+n[6],r[7]=e[7]+n[7],r[8]=e[8]+n[8],r[9]=e[9]+n[9],r[10]=e[10]+n[10],r[11]=e[11]+n[11],r[12]=e[12]+n[12],r[13]=e[13]+n[13],r[14]=e[14]+n[14],r[15]=e[15]+n[15],r}function Tr(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r[6]=e[6]-n[6],r[7]=e[7]-n[7],r[8]=e[8]-n[8],r[9]=e[9]-n[9],r[10]=e[10]-n[10],r[11]=e[11]-n[11],r[12]=e[12]-n[12],r[13]=e[13]-n[13],r[14]=e[14]-n[14],r[15]=e[15]-n[15],r}function Le(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12]*n,r[13]=e[13]*n,r[14]=e[14]*n,r[15]=e[15]*n,r}function Ye(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r[2]=e[2]+n[2]*t,r[3]=e[3]+n[3]*t,r[4]=e[4]+n[4]*t,r[5]=e[5]+n[5]*t,r[6]=e[6]+n[6]*t,r[7]=e[7]+n[7]*t,r[8]=e[8]+n[8]*t,r[9]=e[9]+n[9]*t,r[10]=e[10]+n[10]*t,r[11]=e[11]+n[11]*t,r[12]=e[12]+n[12]*t,r[13]=e[13]+n[13]*t,r[14]=e[14]+n[14]*t,r[15]=e[15]+n[15]*t,r}function Ie(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function Oe(r,e){var n=r[0],t=r[1],a=r[2],i=r[3],s=r[4],h=r[5],c=r[6],x=r[7],v=r[8],p=r[9],f=r[10],M=r[11],m=r[12],y=r[13],l=r[14],E=r[15],A=e[0],z=e[1],g=e[2],d=e[3],_=e[4],L=e[5],R=e[6],Y=e[7],T=e[8],b=e[9],q=e[10],N=e[11],S=e[12],D=e[13],$=e[14],H=e[15];return Math.abs(n-A)<=P*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(t-z)<=P*Math.max(1,Math.abs(t),Math.abs(z))&&Math.abs(a-g)<=P*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(i-d)<=P*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(s-_)<=P*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(h-L)<=P*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(c-R)<=P*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(x-Y)<=P*Math.max(1,Math.abs(x),Math.abs(Y))&&Math.abs(v-T)<=P*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(p-b)<=P*Math.max(1,Math.abs(p),Math.abs(b))&&Math.abs(f-q)<=P*Math.max(1,Math.abs(f),Math.abs(q))&&Math.abs(M-N)<=P*Math.max(1,Math.abs(M),Math.abs(N))&&Math.abs(m-S)<=P*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(y-D)<=P*Math.max(1,Math.abs(y),Math.abs(D))&&Math.abs(l-$)<=P*Math.max(1,Math.abs(l),Math.abs($))&&Math.abs(E-H)<=P*Math.max(1,Math.abs(E),Math.abs(H))}var be=mr,qe=Tr;var C={};ar(C,{add:()=>De,angle:()=>an,bezier:()=>Ue,ceil:()=>ke,clone:()=>Ne,copy:()=>oe,create:()=>W,cross:()=>Z,dist:()=>Mn,distance:()=>Sr,div:()=>pn,divide:()=>Rr,dot:()=>Q,equals:()=>xn,exactEquals:()=>cn,floor:()=>Fe,forEach:()=>yn,fromValues:()=>X,hermite:()=>Ge,inverse:()=>We,len:()=>sr,length:()=>wr,lerp:()=>Xe,max:()=>$e,min:()=>Ve,mul:()=>ln,multiply:()=>Pr,negate:()=>Be,normalize:()=>ir,random:()=>Je,rotateX:()=>en,rotateY:()=>nn,rotateZ:()=>tn,round:()=>He,scale:()=>Qe,scaleAndAdd:()=>Ze,set:()=>Ce,slerp:()=>je,sqrDist:()=>fn,sqrLen:()=>mn,squaredDistance:()=>Lr,squaredLength:()=>Yr,str:()=>hn,sub:()=>vn,subtract:()=>Ar,transformMat3:()=>ue,transformMat4:()=>Ke,transformQuat:()=>rn,zero:()=>sn});function W(){var r=new I(3);return I!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Ne(r){var e=new I(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function wr(r){var e=r[0],n=r[1],t=r[2];return Math.hypot(e,n,t)}function X(r,e,n){var t=new I(3);return t[0]=r,t[1]=e,t[2]=n,t}function oe(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function Ce(r,e,n,t){return r[0]=e,r[1]=n,r[2]=t,r}function De(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r}function Ar(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r}function Pr(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r[2]=e[2]*n[2],r}function Rr(r,e,n){return r[0]=e[0]/n[0],r[1]=e[1]/n[1],r[2]=e[2]/n[2],r}function ke(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r[2]=Math.ceil(e[2]),r}function Fe(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r[2]=Math.floor(e[2]),r}function Ve(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r[2]=Math.min(e[2],n[2]),r}function $e(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r[2]=Math.max(e[2],n[2]),r}function He(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r[2]=Math.round(e[2]),r}function Qe(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r}function Ze(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r[2]=e[2]+n[2]*t,r}function Sr(r,e){var n=e[0]-r[0],t=e[1]-r[1],a=e[2]-r[2];return Math.hypot(n,t,a)}function Lr(r,e){var n=e[0]-r[0],t=e[1]-r[1],a=e[2]-r[2];return n*n+t*t+a*a}function Yr(r){var e=r[0],n=r[1],t=r[2];return e*e+n*n+t*t}function Be(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function We(r,e){return r[0]=1/e[0],r[1]=1/e[1],r[2]=1/e[2],r}function ir(r,e){var n=e[0],t=e[1],a=e[2],i=n*n+t*t+a*a;return i>0&&(i=1/Math.sqrt(i)),r[0]=e[0]*i,r[1]=e[1]*i,r[2]=e[2]*i,r}function Q(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Z(r,e,n){var t=e[0],a=e[1],i=e[2],s=n[0],h=n[1],c=n[2];return r[0]=a*c-i*h,r[1]=i*s-t*c,r[2]=t*h-a*s,r}function Xe(r,e,n,t){var a=e[0],i=e[1],s=e[2];return r[0]=a+t*(n[0]-a),r[1]=i+t*(n[1]-i),r[2]=s+t*(n[2]-s),r}function je(r,e,n,t){var a=Math.acos(Math.min(Math.max(Q(e,n),-1),1)),i=Math.sin(a),s=Math.sin((1-t)*a)/i,h=Math.sin(t*a)/i;return r[0]=s*e[0]+h*n[0],r[1]=s*e[1]+h*n[1],r[2]=s*e[2]+h*n[2],r}function Ge(r,e,n,t,a,i){var s=i*i,h=s*(2*i-3)+1,c=s*(i-2)+i,x=s*(i-1),v=s*(3-2*i);return r[0]=e[0]*h+n[0]*c+t[0]*x+a[0]*v,r[1]=e[1]*h+n[1]*c+t[1]*x+a[1]*v,r[2]=e[2]*h+n[2]*c+t[2]*x+a[2]*v,r}function Ue(r,e,n,t,a,i){var s=1-i,h=s*s,c=i*i,x=h*s,v=3*i*h,p=3*c*s,f=c*i;return r[0]=e[0]*x+n[0]*v+t[0]*p+a[0]*f,r[1]=e[1]*x+n[1]*v+t[1]*p+a[1]*f,r[2]=e[2]*x+n[2]*v+t[2]*p+a[2]*f,r}function Je(r,e){e=e===void 0?1:e;var n=V()*2*Math.PI,t=V()*2-1,a=Math.sqrt(1-t*t)*e;return r[0]=Math.cos(n)*a,r[1]=Math.sin(n)*a,r[2]=t*e,r}function Ke(r,e,n){var t=e[0],a=e[1],i=e[2],s=n[3]*t+n[7]*a+n[11]*i+n[15];return s=s||1,r[0]=(n[0]*t+n[4]*a+n[8]*i+n[12])/s,r[1]=(n[1]*t+n[5]*a+n[9]*i+n[13])/s,r[2]=(n[2]*t+n[6]*a+n[10]*i+n[14])/s,r}function ue(r,e,n){var t=e[0],a=e[1],i=e[2];return r[0]=t*n[0]+a*n[3]+i*n[6],r[1]=t*n[1]+a*n[4]+i*n[7],r[2]=t*n[2]+a*n[5]+i*n[8],r}function rn(r,e,n){var t=n[0],a=n[1],i=n[2],s=n[3],h=e[0],c=e[1],x=e[2],v=a*x-i*c,p=i*h-t*x,f=t*c-a*h,M=a*f-i*p,m=i*v-t*f,y=t*p-a*v,l=s*2;return v*=l,p*=l,f*=l,M*=2,m*=2,y*=2,r[0]=h+v+M,r[1]=c+p+m,r[2]=x+f+y,r}function en(r,e,n,t){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0],i[1]=a[1]*Math.cos(t)-a[2]*Math.sin(t),i[2]=a[1]*Math.sin(t)+a[2]*Math.cos(t),r[0]=i[0]+n[0],r[1]=i[1]+n[1],r[2]=i[2]+n[2],r}function nn(r,e,n,t){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[2]*Math.sin(t)+a[0]*Math.cos(t),i[1]=a[1],i[2]=a[2]*Math.cos(t)-a[0]*Math.sin(t),r[0]=i[0]+n[0],r[1]=i[1]+n[1],r[2]=i[2]+n[2],r}function tn(r,e,n,t){var a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0]*Math.cos(t)-a[1]*Math.sin(t),i[1]=a[0]*Math.sin(t)+a[1]*Math.cos(t),i[2]=a[2],r[0]=i[0]+n[0],r[1]=i[1]+n[1],r[2]=i[2]+n[2],r}function an(r,e){var n=r[0],t=r[1],a=r[2],i=e[0],s=e[1],h=e[2],c=Math.sqrt((n*n+t*t+a*a)*(i*i+s*s+h*h)),x=c&&Q(r,e)/c;return Math.acos(Math.min(Math.max(x,-1),1))}function sn(r){return r[0]=0,r[1]=0,r[2]=0,r}function hn(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"}function cn(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]}function xn(r,e){var n=r[0],t=r[1],a=r[2],i=e[0],s=e[1],h=e[2];return Math.abs(n-i)<=P*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(t-s)<=P*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(a-h)<=P*Math.max(1,Math.abs(a),Math.abs(h))}var vn=Ar,ln=Pr,pn=Rr,Mn=Sr,fn=Lr,sr=wr,mn=Yr,yn=function(){var r=W();return function(e,n,t,a,i,s){var h,c;for(n||(n=3),t||(t=0),a?c=Math.min(a*n+t,e.length):c=e.length,h=t;h<c;h+=n)r[0]=e[h],r[1]=e[h+1],r[2]=e[h+2],i(r,r,s),e[h]=r[0],e[h+1]=r[1],e[h+2]=r[2];return e}}();function gn(){var r=new I(4);return I!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function Ir(r,e){var n=e[0],t=e[1],a=e[2],i=e[3],s=n*n+t*t+a*a+i*i;return s>0&&(s=1/Math.sqrt(s)),r[0]=n*s,r[1]=t*s,r[2]=a*s,r[3]=i*s,r}var h1=function(){var r=gn();return function(e,n,t,a,i,s){var h,c;for(n||(n=4),t||(t=0),a?c=Math.min(a*n+t,e.length):c=e.length,h=t;h<c;h+=n)r[0]=e[h],r[1]=e[h+1],r[2]=e[h+2],r[3]=e[h+3],i(r,r,s),e[h]=r[0],e[h+1]=r[1],e[h+2]=r[2],e[h+3]=r[3];return e}}();function cr(){var r=new I(4);return I!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function dn(r,e,n){n=n*.5;var t=Math.sin(n);return r[0]=t*e[0],r[1]=t*e[1],r[2]=t*e[2],r[3]=Math.cos(n),r}function hr(r,e,n,t){var a=e[0],i=e[1],s=e[2],h=e[3],c=n[0],x=n[1],v=n[2],p=n[3],f,M,m,y,l;return M=a*c+i*x+s*v+h*p,M<0&&(M=-M,c=-c,x=-x,v=-v,p=-p),1-M>P?(f=Math.acos(M),m=Math.sin(f),y=Math.sin((1-t)*f)/m,l=Math.sin(t*f)/m):(y=1-t,l=t),r[0]=y*a+l*c,r[1]=y*i+l*x,r[2]=y*s+l*v,r[3]=y*h+l*p,r}function _n(r,e){var n=e[0]+e[4]+e[8],t;if(n>0)t=Math.sqrt(n+1),r[3]=.5*t,t=.5/t,r[0]=(e[5]-e[7])*t,r[1]=(e[6]-e[2])*t,r[2]=(e[1]-e[3])*t;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var i=(a+1)%3,s=(a+2)%3;t=Math.sqrt(e[a*3+a]-e[i*3+i]-e[s*3+s]+1),r[a]=.5*t,t=.5/t,r[3]=(e[i*3+s]-e[s*3+i])*t,r[i]=(e[i*3+a]+e[a*3+i])*t,r[s]=(e[s*3+a]+e[a*3+s])*t}return r}var br=Ir;var z1=function(){var r=W(),e=X(1,0,0),n=X(0,1,0);return function(t,a,i){var s=Q(a,i);return s<-.999999?(Z(r,e,a),sr(r)<1e-6&&Z(r,n,a),ir(r,r),dn(t,r,Math.PI),t):s>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Z(r,a,i),t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=1+s,br(t,t))}}(),E1=function(){var r=cr(),e=cr();return function(n,t,a,i,s,h){return hr(r,t,s,h),hr(e,a,i,h),hr(n,r,e,2*h*(1-h)),n}}(),T1=function(){var r=pr();return function(e,n,t,a){return r[0]=t[0],r[3]=t[1],r[6]=t[2],r[1]=a[0],r[4]=a[1],r[7]=a[2],r[2]=-n[0],r[5]=-n[1],r[8]=-n[2],br(e,_n(e,r))}}();var B={};ar(B,{add:()=>Pn,angle:()=>Bn,ceil:()=>Rn,clone:()=>En,copy:()=>wn,create:()=>Nr,cross:()=>Dn,dist:()=>r1,distance:()=>kr,div:()=>un,divide:()=>Dr,dot:()=>Cn,equals:()=>Gn,exactEquals:()=>jn,floor:()=>Sn,forEach:()=>t1,fromValues:()=>Tn,inverse:()=>Nn,len:()=>Un,length:()=>Vr,lerp:()=>kn,max:()=>Yn,min:()=>Ln,mul:()=>Kn,multiply:()=>Cr,negate:()=>qn,normalize:()=>on,random:()=>Fn,rotate:()=>Zn,round:()=>In,scale:()=>On,scaleAndAdd:()=>bn,set:()=>An,sqrDist:()=>e1,sqrLen:()=>n1,squaredDistance:()=>Fr,squaredLength:()=>$r,str:()=>Xn,sub:()=>Jn,subtract:()=>or,transformMat2:()=>Vn,transformMat2d:()=>$n,transformMat3:()=>Hn,transformMat4:()=>Qn,zero:()=>Wn});function Nr(){var r=new I(2);return I!=Float32Array&&(r[0]=0,r[1]=0),r}function En(r){var e=new I(2);return e[0]=r[0],e[1]=r[1],e}function Tn(r,e){var n=new I(2);return n[0]=r,n[1]=e,n}function wn(r,e){return r[0]=e[0],r[1]=e[1],r}function An(r,e,n){return r[0]=e,r[1]=n,r}function Pn(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r}function or(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r}function Cr(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r}function Dr(r,e,n){return r[0]=e[0]/n[0],r[1]=e[1]/n[1],r}function Rn(r,e){return r[0]=Math.ceil(e[0]),r[1]=Math.ceil(e[1]),r}function Sn(r,e){return r[0]=Math.floor(e[0]),r[1]=Math.floor(e[1]),r}function Ln(r,e,n){return r[0]=Math.min(e[0],n[0]),r[1]=Math.min(e[1],n[1]),r}function Yn(r,e,n){return r[0]=Math.max(e[0],n[0]),r[1]=Math.max(e[1],n[1]),r}function In(r,e){return r[0]=Math.round(e[0]),r[1]=Math.round(e[1]),r}function On(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r}function bn(r,e,n,t){return r[0]=e[0]+n[0]*t,r[1]=e[1]+n[1]*t,r}function kr(r,e){var n=e[0]-r[0],t=e[1]-r[1];return Math.hypot(n,t)}function Fr(r,e){var n=e[0]-r[0],t=e[1]-r[1];return n*n+t*t}function Vr(r){var e=r[0],n=r[1];return Math.hypot(e,n)}function $r(r){var e=r[0],n=r[1];return e*e+n*n}function qn(r,e){return r[0]=-e[0],r[1]=-e[1],r}function Nn(r,e){return r[0]=1/e[0],r[1]=1/e[1],r}function on(r,e){var n=e[0],t=e[1],a=n*n+t*t;return a>0&&(a=1/Math.sqrt(a)),r[0]=e[0]*a,r[1]=e[1]*a,r}function Cn(r,e){return r[0]*e[0]+r[1]*e[1]}function Dn(r,e,n){var t=e[0]*n[1]-e[1]*n[0];return r[0]=r[1]=0,r[2]=t,r}function kn(r,e,n,t){var a=e[0],i=e[1];return r[0]=a+t*(n[0]-a),r[1]=i+t*(n[1]-i),r}function Fn(r,e){e=e===void 0?1:e;var n=V()*2*Math.PI;return r[0]=Math.cos(n)*e,r[1]=Math.sin(n)*e,r}function Vn(r,e,n){var t=e[0],a=e[1];return r[0]=n[0]*t+n[2]*a,r[1]=n[1]*t+n[3]*a,r}function $n(r,e,n){var t=e[0],a=e[1];return r[0]=n[0]*t+n[2]*a+n[4],r[1]=n[1]*t+n[3]*a+n[5],r}function Hn(r,e,n){var t=e[0],a=e[1];return r[0]=n[0]*t+n[3]*a+n[6],r[1]=n[1]*t+n[4]*a+n[7],r}function Qn(r,e,n){var t=e[0],a=e[1];return r[0]=n[0]*t+n[4]*a+n[12],r[1]=n[1]*t+n[5]*a+n[13],r}function Zn(r,e,n,t){var a=e[0]-n[0],i=e[1]-n[1],s=Math.sin(t),h=Math.cos(t);return r[0]=a*h-i*s+n[0],r[1]=a*s+i*h+n[1],r}function Bn(r,e){var n=r[0],t=r[1],a=e[0],i=e[1],s=Math.sqrt((n*n+t*t)*(a*a+i*i)),h=s&&(n*a+t*i)/s;return Math.acos(Math.min(Math.max(h,-1),1))}function Wn(r){return r[0]=0,r[1]=0,r}function Xn(r){return"vec2("+r[0]+", "+r[1]+")"}function jn(r,e){return r[0]===e[0]&&r[1]===e[1]}function Gn(r,e){var n=r[0],t=r[1],a=e[0],i=e[1];return Math.abs(n-a)<=P*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(t-i)<=P*Math.max(1,Math.abs(t),Math.abs(i))}var Un=Vr,Jn=or,Kn=Cr,un=Dr,r1=kr,e1=Fr,n1=$r,t1=function(){var r=Nr();return function(e,n,t,a,i,s){var h,c;for(n||(n=2),t||(t=0),a?c=Math.min(a*n+t,e.length):c=e.length,h=t;h<c;h+=n)r[0]=e[h],r[1]=e[h+1],i(r,r,s),e[h]=r[0],e[h+1]=r[1];return e}}();var j=class{constructor(e){this.trans_mat=O.create(),O.fromTranslation(this.trans_mat,[e.width/2,e.height/2,0]),O.scale(this.trans_mat,this.trans_mat,[1,-1,1])}transformTo(e){return this}};function xr(r,e){let n=r.getBoundingClientRect(),t=e.clientX-n.left,a=e.clientY-n.top;return[t,a]}function G(){let r=document.getElementById("myCanvas"),e=r.getContext("2d");return{canvas:r,ctx:e}}var U=class{constructor(){let{canvas:e,ctx:n}=G();this.canvas=e,e.addEventListener("mouseover",t=>{this.inside=!0,this.curr=xr(e,t)}),e.addEventListener("mouseout",()=>{this.inside=!1,this.down=!1}),e.addEventListener("mousedown",()=>{this.down=!0}),e.addEventListener("mouseup",()=>{this.down=!1})}mouseDrag(e){this.canvas.addEventListener("mousemove",n=>{if(this.prev=this.curr,this.curr=xr(this.canvas,n),this.down&&this.inside){let t=B.create();B.sub(t,this.curr,this.prev),e(t)}})}mouseWheel(e){this.canvas.addEventListener("wheel",n=>{n.preventDefault(),this.inside&&e(n.deltaY)})}logStates(){console.log("down: ",this.down,"inside: ",this.inside,"curr: ",this.curr)}};var J=class{constructor(){this.moveEye=e=>{this.eye[0]=this.inLimit(e[0])?this.eye[0]+-e[0]/10:this.eye[0],this.eye[1]=this.inLimit(e[1])?this.eye[1]+-e[1]/10:this.eye[1],O.lookAt(this.trans_mat,this.eye,this.target,this.up)};this.trans_mat=O.create(),this.eye=C.fromValues(30,40,50),this.target=C.fromValues(0,0,0),this.up=C.fromValues(0,1,0),O.lookAt(this.trans_mat,this.eye,this.target,this.up),this.event=new U,this.event.mouseDrag(this.moveEye)}transformTo(e){return this.trans_mat=O.create(),O.lookAt(this.trans_mat,this.eye,this.target,this.up),O.multiply(this.trans_mat,e.trans_mat,this.trans_mat),this}inLimit(e){return!0}};function o(r,e,n){let t=C.create();C.transformMat4(t,r,e),n.moveTo(t[0],t[1])}function w(r,e,n){let t=C.create();C.transformMat4(t,r,e),n.lineTo(t[0],t[1])}var K=class{constructor(e=1/0){this.capacity=e;this.storage=[]}enqueue(e){this.size()<=this.capacity&&this.storage.push(e)}dequeue(){return this.storage.shift()}size(){return this.storage.length}};var u=class{constructor(e,n){this.trans_mat=O.create(),this.context=e,this.scale=n}renderAxes(e){this.context.strokeStyle=e,this.context.lineWidth=1,this.context.beginPath(),o([1.2,0,0],this.trans_mat,this.context),w([-1.2,0,0],this.trans_mat,this.context),o([0,0,0],this.trans_mat,this.context),w([0,1.2,0],this.trans_mat,this.context),w([0,-1.2,0],this.trans_mat,this.context),o([0,0,0],this.trans_mat,this.context),w([0,0,1.2],this.trans_mat,this.context),w([0,0,-1.2],this.trans_mat,this.context),o([1.1,.05,0],this.trans_mat,this.context),w([1.2,0,0],this.trans_mat,this.context),w([1.1,-.05,0],this.trans_mat,this.context),o([.05,1.1,0],this.trans_mat,this.context),w([0,1.2,0],this.trans_mat,this.context),w([-.05,1.1,0],this.trans_mat,this.context),o([.05,0,1.1],this.trans_mat,this.context),w([0,0,1.2],this.trans_mat,this.context),w([-.05,0,1.1],this.trans_mat,this.context),o([1.3,-.05,0],this.trans_mat,this.context),w([1.4,.05,0],this.trans_mat,this.context),o([1.3,.05,0],this.trans_mat,this.context),w([1.4,-.05,0],this.trans_mat,this.context),o([-.05,1.4,0],this.trans_mat,this.context),w([0,1.35,0],this.trans_mat,this.context),w([.05,1.4,0],this.trans_mat,this.context),o([0,1.35,0],this.trans_mat,this.context),w([0,1.28,0],this.trans_mat,this.context),o([-.05,0,1.3],this.trans_mat,this.context),w([.05,0,1.3],this.trans_mat,this.context),w([-.05,0,1.4],this.trans_mat,this.context),w([.05,0,1.4],this.trans_mat,this.context),this.context.stroke()}renderCubeTrace(e){this.context.strokeStyle=`rgba(${e.rgb_color[0]}, ${e.rgb_color[1]}, ${e.rgb_color[2]})`,this.context.lineWidth=2,this.context.beginPath();for(let n=0;n<e.prev_mat_queue.size();n++)w([0,0,0],e.prev_mat_queue.storage[n],this.context);this.context.stroke(),e.prev_mat_queue.size()>=20&&e.prev_mat_queue.dequeue()}transformTo(e){return this.trans_mat=O.create(),O.scale(this.trans_mat,this.trans_mat,[this.scale,this.scale,this.scale]),O.multiply(this.trans_mat,e.trans_mat,this.trans_mat),this}};var F=class{constructor(e,n,t,a=!1,i=[1,1,1],s=.2,h=[0,68,255]){this.trans_mat=[0,0,0];this.isInit=!0;this.step=10;this.counter=0;this.context=e,this.scale=n,this.location=t,this.deg=a?1:0,this.speed=s,this.rgb_color=h,this.rotate_vec=i,this.prev_mat_queue=new K(1e3)}transformTo(e){this.isInit&&(this.next=e),this.isInit=!1,this.counter%this.step===0&&this.prev_mat_queue.enqueue(O.clone(this.trans_mat)),this.counter=(this.counter+1)%this.step,this.trans_mat=O.create();let n=this.deg*Math.PI/180;return O.fromTranslation(this.trans_mat,this.location),O.rotate(this.trans_mat,this.trans_mat,n,this.rotate_vec),O.multiply(this.trans_mat,e.trans_mat,this.trans_mat),this}render(){this.context.fillStyle=`rgba(${this.rgb_color[0]}, ${this.rgb_color[1]}, ${this.rgb_color[2]})`,this.context.beginPath(),o([0,0,0],this.trans_mat,this.context),w([this.scale,0,0],this.trans_mat,this.context),w([this.scale,0,this.scale],this.trans_mat,this.context),w([0,0,this.scale],this.trans_mat,this.context),w([0,0,0],this.trans_mat,this.context),this.context.fill(),this.context.beginPath(),o([0,0,0],this.trans_mat,this.context),w([this.scale,0,0],this.trans_mat,this.context),w([this.scale,this.scale,0],this.trans_mat,this.context),w([0,this.scale,0],this.trans_mat,this.context),w([0,0,0],this.trans_mat,this.context),this.context.fill(),this.context.fillStyle=`rgba(${this.rgb_color[0]+30}, ${this.rgb_color[1]+30}, ${this.rgb_color[2]})`,this.context.beginPath(),o([0,0,0],this.trans_mat,this.context),w([0,0,this.scale],this.trans_mat,this.context),w([0,this.scale,this.scale],this.trans_mat,this.context),w([0,this.scale,0],this.trans_mat,this.context),w([0,0,0],this.trans_mat,this.context),this.context.fill(),this.context.beginPath(),o([this.scale,this.scale,this.scale],this.trans_mat,this.context),w([this.scale,this.scale,0],this.trans_mat,this.context),w([0,this.scale,0],this.trans_mat,this.context),w([0,this.scale,this.scale],this.trans_mat,this.context),w([this.scale,this.scale,this.scale],this.trans_mat,this.context),this.context.fill(),this.context.fillStyle=`rgba(${this.rgb_color[0]}, ${this.rgb_color[1]}, ${this.rgb_color[2]})`,this.context.beginPath(),o([this.scale,this.scale,this.scale],this.trans_mat,this.context),w([this.scale,this.scale,0],this.trans_mat,this.context),w([this.scale,0,0],this.trans_mat,this.context),w([this.scale,0,this.scale],this.trans_mat,this.context),w([this.scale,this.scale,this.scale],this.trans_mat,this.context),this.context.fill(),this.context.fillStyle=`rgba(${this.rgb_color[0]+30}, ${this.rgb_color[1]+30}, ${this.rgb_color[2]})`,this.context.beginPath(),o([this.scale,this.scale,this.scale],this.trans_mat,this.context),w([0,this.scale,this.scale],this.trans_mat,this.context),w([0,0,this.scale],this.trans_mat,this.context),w([this.scale,0,this.scale],this.trans_mat,this.context),w([this.scale,this.scale,this.scale],this.trans_mat,this.context),this.context.fill(),this.deg!==0&&(this.deg=(this.deg+this.speed)%360)}};var rr=class{constructor(e){this.selection=document.querySelector(e),this.selection.addEventListener("change",n=>{this.selection.checked=!!this.selection.checked})}get checked(){return this.selection.checked}};var er=class{constructor(){this.selection=document.querySelector("#fps")}track(){if(!this.lastCalledTime){this.lastCalledTime=performance.now(),this.fps=0;return}let e=(performance.now()-this.lastCalledTime)/1e3;this.lastCalledTime=performance.now(),this.fps=Math.floor(1/e),this.selection.innerText=`FPS: ${this.fps}`}};var nr=class{constructor(e){this.trans_mat=O.create(),this.canvas=e}transformTo(e){return O.perspective(this.trans_mat,.001,this.canvas.width/this.canvas.height,-1,null),O.multiply(this.trans_mat,e.trans_mat,this.trans_mat),this}};var tr=class{constructor(){this.render=()=>{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.world.transformTo(this.camera.transformTo(this.projection.transformTo(this.viewport))),this.solar_system.sun.transformTo(this.world),this.solar_system.planet1.transformTo(this.solar_system.sun),this.solar_system.planet2.transformTo(this.solar_system.sun),this.solar_system.planet1_moon1.transformTo(this.solar_system.planet1),this.solar_system.planet2_moon1.transformTo(this.solar_system.planet2),this.solar_system.planet2_moon2.transformTo(this.solar_system.planet2),this.solar_system.planet2_moon2_moon1.transformTo(this.solar_system.planet2_moon2),this.gridCheckbox.checked&&this.world.renderAxes("grey");for(let e in this.solar_system)this.world.renderCubeTrace(this.solar_system[e]),this.solar_system[e].render();this.tracker.track(),requestAnimationFrame(this.render)};let{canvas:e,ctx:n}=G();this.tracker=new er,this.ctx=n,this.canvas=e,this.viewport=new j(e),this.projection=new nr(e),this.camera=new J,this.world=new u(n,4e4);let t=.35;this.solar_system={sun:new F(n,t,[-t/2,-t/2,-t/2],!0,[-1,-1,-1],.3),planet1:new F(n,.1,[.6,.6,0],!0,[1,1,1],.7,[255,60,41]),planet1_moon1:new F(n,.05,[.15,.15,-.15],!0,[-1,-1,-1],2,[26,186,9]),planet2:new F(n,.2,[-.6,-.6,.4],!0,[-1,-1,-1],.25,[75,9,186]),planet2_moon1:new F(n,.11,[-.3,.3,.2],!0,[1,2,3],.9,[176,175,9]),planet2_moon2:new F(n,.08,[.3,-.3,-.2],!0,[-2,-3,-1],1.2,[9,176,175]),planet2_moon2_moon1:new F(n,.04,[.1,.5,.1],!0,[-1,1,-1],2,[130,60,41])},this.gridCheckbox=new rr("#grid")}};var a1=new tr;a1.render();})();
//# sourceMappingURL=index.js.map
